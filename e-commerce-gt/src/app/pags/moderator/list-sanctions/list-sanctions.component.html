<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <!-- Header -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-danger text-white">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>
              Historial de Sanciones
            </h4>
            <span class="badge bg-white text-danger">
              Total: {{ totalSanciones }}
            </span>
          </div>
        </div>
      </div>

      <!-- Mensajes de estado -->
      @if (mensajeExito) {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          <i class="bi bi-check-circle-fill me-2"></i>
          {{ mensajeExito }}
          <button type="button" class="btn-close" (click)="ocultarMensajes()"></button>
        </div>
      }

      @if (mensajeError) {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
          <i class="bi bi-exclamation-circle-fill me-2"></i>
          {{ mensajeError }}
          <button type="button" class="btn-close" (click)="ocultarMensajes()"></button>
        </div>
      }

      <!-- Loading spinner -->
      @if (isLoading) {
        <div class="text-center py-5">
          <div class="spinner-border text-danger" role="status">
            <span class="visually-hidden">Cargando...</span>
          </div>
          <p class="mt-3 text-muted">Cargando sanciones...</p>
        </div>
      }

      <!-- Tabla de sanciones -->
      @if (!isLoading) {
        <div class="card shadow-sm">
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-hover table-striped mb-0">
                <thead class="table-dark">
                  <tr>
                    <th scope="col" class="text-center">#</th>
                    <th scope="col">
                      <i class="bi bi-person-fill me-2"></i>Usuario
                    </th>
                    <th scope="col">
                      <i class="bi bi-envelope-fill me-2"></i>Email
                    </th>
                    <th scope="col">
                      <i class="bi bi-chat-left-text-fill me-2"></i>Motivo
                    </th>
                    <th scope="col" class="text-center">
                      <i class="bi bi-calendar-event-fill me-2"></i>Fecha
                    </th>
                  </tr>
                </thead>
                <tbody>
                  @if (sanciones.length === 0) {
                    <tr>
                      <td colspan="5" class="text-center py-5">
                        <i class="bi bi-inbox text-muted fs-1"></i>
                        <p class="text-muted mt-3 mb-0">No hay sanciones registradas</p>
                      </td>
                    </tr>
                  }
                  @for (sancion of sanciones; track sancion.id_sancion; let i = $index) {
                    <tr>
                      <td class="text-center align-middle">
                        <span class="badge bg-secondary">{{ sancion.id_sancion }}</span>
                      </td>
                      <td class="align-middle">
                        <i class="bi bi-person-circle text-danger me-2"></i>
                        <strong>{{ sancion.nombre_usuario || 'N/A' }}</strong>
                      </td>
                      <td class="align-middle">
                        <i class="bi bi-envelope text-muted me-2"></i>
                        {{ sancion.email_usuario || 'N/A' }}
                      </td>
                      <td class="align-middle">
                        <span class="text-danger">
                          <i class="bi bi-exclamation-circle me-1"></i>
                          {{ sancion.motivo }}
                        </span>
                      </td>
                      <td class="text-center align-middle">
                        <small class="text-muted">
                          <i class="bi bi-clock me-1"></i>
                          {{ sancion.fechaFormateada }}
                        </small>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>

          <!-- Paginación -->
          @if (totalPaginas > 1) {
            <div class="card-footer bg-light">
              <nav aria-label="Paginación de sanciones">
                <ul class="pagination justify-content-center mb-0">
                  <!-- Botón anterior -->
                  <li class="page-item" [class.disabled]="paginaActual === 1">
                    <button 
                      class="page-link" 
                      (click)="cambiarPagina(paginaActual - 1)"
                      [disabled]="paginaActual === 1">
                      <i class="bi bi-chevron-left"></i>
                      Anterior
                    </button>
                  </li>

                  <!-- Primera página -->
                  <li class="page-item" [class.active]="paginaActual === 1">
                    <button class="page-link" (click)="cambiarPagina(1)">1</button>
                  </li>

                  <!-- Puntos suspensivos inicio -->
                  @if (paginaActual > 3) {
                    <li class="page-item disabled">
                      <span class="page-link">...</span>
                    </li>
                  }

                  <!-- Páginas intermedias -->
                  @for (pagina of obtenerPaginasVisibles(); track pagina) {
                    <li class="page-item" [class.active]="paginaActual === pagina">
                      <button class="page-link" (click)="cambiarPagina(pagina)">
                        {{ pagina }}
                      </button>
                    </li>
                  }

                  <!-- Puntos suspensivos final -->
                  @if (paginaActual < totalPaginas - 2) {
                    <li class="page-item disabled">
                      <span class="page-link">...</span>
                    </li>
                  }

                  <!-- Última página -->
                  @if (totalPaginas > 1) {
                    <li class="page-item" [class.active]="paginaActual === totalPaginas">
                      <button class="page-link" (click)="cambiarPagina(totalPaginas)">
                        {{ totalPaginas }}
                      </button>
                    </li>
                  }

                  <!-- Botón siguiente -->
                  <li class="page-item" [class.disabled]="paginaActual === totalPaginas">
                    <button 
                      class="page-link" 
                      (click)="cambiarPagina(paginaActual + 1)"
                      [disabled]="paginaActual === totalPaginas">
                      Siguiente
                      <i class="bi bi-chevron-right"></i>
                    </button>
                  </li>
                </ul>
              </nav>

              <!-- Info de paginación -->
              <div class="text-center mt-3">
                <small class="text-muted">
                  <i class="bi bi-info-circle me-1"></i>
                  Página {{ paginaActual }} de {{ totalPaginas }} 
                  ({{ totalSanciones }} sanciones en total)
                </small>
              </div>

              <!-- Selector de tamaño de página -->
              <div class="text-center mt-2">
                <div class="btn-group btn-group-sm" role="group">
                  <button 
                    type="button" 
                    class="btn btn-outline-secondary"
                    [class.active]="tamanoPagina === 5"
                    (click)="cambiarTamanoPagina(5)">
                    5
                  </button>
                  <button 
                    type="button" 
                    class="btn btn-outline-secondary"
                    [class.active]="tamanoPagina === 10"
                    (click)="cambiarTamanoPagina(10)">
                    10
                  </button>
                  <button 
                    type="button" 
                    class="btn btn-outline-secondary"
                    [class.active]="tamanoPagina === 25"
                    (click)="cambiarTamanoPagina(25)">
                    25
                  </button>
                  <button 
                    type="button" 
                    class="btn btn-outline-secondary"
                    [class.active]="tamanoPagina === 50"
                    (click)="cambiarTamanoPagina(50)">
                    50
                  </button>
                </div>
                <small class="text-muted ms-2">registros por página</small>
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>